# Симуляции низкого разрешения для нашего мира

Баранов Владимир

Санкт-Петербургский Государственный Университет Аэрокосмического Приборостроения

2019 г.

last update: 12 aug 2021

## Введение

На протяжении многих лет после того как была выдвинут аргумент о симуляции Ником Бостром в 2003 г. в статье [1] многими исследователями делались попытки расчета вычислительной мощности компьютера необходимой для симуляции мира похожего на наш. Бостром в своих статьях пишет об исторической симуляции которую запустила цивилизация достигшая постчеловеческой стадии развития. В которой будет создан искусственный интеллект мыслящий на порядки быстрее чем обычный человек и способный участвовать в рендеринге мира для конкретного игрока или наблюдателя.
Разумно предположить что искусственный интеллект разрабатывая историческую симуляцию реализует в ней множество оптимизаций для уменьшения нагрузки на основной компьютер, ведь как указывает Бостром им необходимо запустить астрономическое количество таких симуляций, учитывая и то что симуляции как виртуальные машины  могут быть вложенными. Бостром отмечает что за одну секунду такой компьютер сможет симулировать жизнь целой человеческой цивилизации (~100 млд. людей). 

Как же достигается подобная эффективность вычислений? Когда у нашей цивилизации появятся возможности для запуска симуляции? Какие технологии, алгоритмы существующие уже сейчас помогут реализовать это грандиозный проект, сравнимый разве что с Манхэттенским. Почему на исследование внеземных цивилизаций выделяются коллосальные средства (SETI), а на разработку технологии симуляции не выделяется практически ничего?
Может оказаться что наши космические программы - пустая трата ресурсов

## Ранее приведеннные прикидки скорости вычислений для мира
Robert J. Bradbury [2] предлагает количество операций компьютера размером в планету состовляет около 10^42 инструкций в секунду. Сет Ллойд в статье [3] предполагает верхний предел вычислений для компьютера в один килограмм 5*10^50 операций в секунду.

### Скорость вычислений необходимая для симуляции мозга также различается у разных авторов и находятся в интервале 10^16-10^17 операций в секунду

Мое личное понимание гипотезы симуляции. Когда я вообще задумался на эту тему

Когда я рос у бабушки, мы любили ходить на базу и играть в компьютерные игры. Так назывался домик с компьютерными автоматами. Это были довольно медленные компьютеры, но они позволяли создать на экране двумерный виртуальный мир, который подчинялся определенным правилам, где-то даже напоминавшими законы физики.   Даже играя в примитивные 2д аркады я всегда удивлялся ограничениям которые были в виртуальном мире. Почему нельзя вернуться назад или разрушить стену. Тогда я начал понимать что все упирается в обьем памяти и производительность процессора. 

В то время на экраны вышел фильм Терминатор 2.  Мне нравилась одна сцена где Арнольд Шварценеггер угоняет машину разбив кулаком окно, берет ключи из бардачка, заводит машину и уезжает. И я подумал что в будущем будет создана игра в которой можно будет также как и Арнольд угонять тачки в 3х мерном мире. Когда ребята из провинциального городка спросили в какие игры вы там у себя играете я им наплел что играю в такого рода игры. Они конечно мне не поверили. Кто же мог тогда подумать что через 10 лет появится игра Grand Threft Auto.

Позже занявшись программированием я узнал что уровень детализации это важнейшая часть игровых движков ( называется LOD, от англ. аббв. Level Of Details ). Например рельеф местности и обьекты на нем можно отобразить с помощью quad tree. Наш мир может симулироваться на том уровне детализации который может воспринять наблюдатель. 

Иногда возникает вопрос когда я был подключен к матрице. 
Я родился в симуляции? Я был недавно подключен к симуляции? Симуляция существует с начала Большого Взрыва или как в матрице с 1999? Может быть симулируется только место где я живу, симуляция расширяется взависимости от моих движений? Остальные места например видео с ютьюба подгружаются из других симуляций?:
http://consc.net/papers/matrix.pdf

Еще в школе мы строили платоновы тела, допустим конус может быть построен с помощью правильных многогранников. Идея LOD прослеживается в русской философии например, Николай Кузанский пишет.
"Разум так же близок истине, как многоугольник близок к кругу, чем больше число углов вписанного многоугольника тем он близок к кругу. Но не когда он не будет тождественен кругу."

Во время моей учебы в старших классах на экран вышел фильм Матрица. Где основной идеей фильма было то что мир это компьютерная симуляция, наподобии тех в какие я играл в детстве. Я помню как вырезал из фильма кусочек где Морфиус на белом фоне подходит к старенькому телевизору и показывает Нео в каком мире он жил и какой мир на самом деле.
Чуть позже в университете я прочел книгу Ника Бостром и Сета Ллойда в которых законы физики реальной вселенной были представлены как операции над битами. 

    Хоть гипотезу о симуляции нельзя подтвердить эксперементально, я придаю ей не нулевую вероятность. (update) см. [17]

Когда я в серьез задумался о гипотезе симуляции я начал пересматривать события своей жизни в контексте этой гипотезы. Трудно поверить в то что у жизни нет смысла. Т.к естесственный отбор в принципе не имеет никакого направления Но если предположить что мир это высокоуровневая симуляция, то возможно наши жизни имеют смысл только в контексте этой симуляции и служат ее целям. К примеру наша симуляция нужна чтобы проверить какую нибудь математическую гипотезу и все атомы в нашем мире служат основой для такого расчета.

## Скорости вычислений в случае разумного расхода вычислительных ресурсов
Сет Ллойд в своей книге "программируя вселенную" исходит их материалистической концепции что мир фундаментально материалистический.  И "большой" мир как бы возникает из элементарных взаимодействий этого огромного количества частиц. Ллойд в одной из своих лекций упомянул что для симуляции вселенной потребуется компьютер размером со вселенную иначе он схлопнется в черную дыру. Но почему он так уверен что нужно симулировать всю вселенную 10^122 атомов. Шахматисты назвали бы такой метод bruite force. или метод грубой силы. Надо упомянуть такой критически важный для виртуальной реальности термин как уровень детализации (level of detail) 

Во первых симулировать нужно не всю вселенную, а только одну обитаемую планету. Это можно осуществить на гипотетически возможном астроинженерном компьютере матрешка брейнс (или несколько конценрических сфер Дайсона вокруг любой из миллиардов звезд). Мощности такой штуки будет достаточно на миллионы оптимальных в моем смысле слова симуляций за секунду реального времени в которых проходит тысячи лет симулируемого времени.

Вместо тупого часового механизма в случае исторической симуляции мы имеем дело с искусственным интеллектом стоящим как бы за сценой. И он может решать какие обьекты мира нужно расчитывать с каким уровнем детализации и делать это не снизу вверх, а наоборот сверху вниз как делается в любом современном игровом движке. К примеру химические реакции вычислять довольно накладно, потому что это требует спускания на уровень молекул. Но обычный обыватель сталкивается с химическими реакциями только когда готовит себе еду и когда эта еда выходит не буду уточнять откуда. И то в случае меня требуется расчитать что с вероятностью 3% добавлю в яичницу перца, с вероятностью 10% я сделаю амлет, с вероятностью 2% я пересолю яичницу. Результатом такой симуляции может быть выбор из таблицы готовых результатов не симулируя никаких химических реакций. Метод Монте-Карло может помочь в такого рода симуляциях [10]. Метод Монте-Карло относится к имитационному моделированию, в котором при расчете какой-либо системы воспроизводится и исследуется поведение всех ее компонентов. Как же можно моделировать сложную систему, не зная строгих математических законов, которым она подчиняется? Ответ на этот вопрос содержится в назывании категории метода — «имитационный». Если поведение системы достаточно сложно и нет возможности описать его строгими математическими формулами, необходимо поставить определенное число экспериментов (т.н. случайных испытаний) с каждым из узлов этой системы для того, чтобы оценить, как они себя ведут.  Кроме метода Монте-Карло можно применить универсальные аппроксиматоры функций -  нейронные сети. Они могут использоваться для моделирования химических реакций путем приблизительного решения уравнения Шредингера.[16] Это экономит огромную кучу вычислений. Все что вам нужно - это просимулировать приготовление яичницы несколько раз и использовать эти результаты каждый раз как кто-то будет готовить себе яичницу на завтрак.

Томас Кэмпбелл в одной из своих лекций приводит в пример стрельбу ядра из пушки [4]. Этот пример демонстрирует общий принцип моделирования на основе вероятностных распределений. Если вы начнете медленный процесс детерминистической симуляции, то он займет недели на лучших суперкомпьютерах. Миллиарды молекул, как энергия взрыва распространяется по пушке и доходит до ядра. Выходящий газ заставляет ядро закручиваться в определенном направлении. И все это значительно влияет на то где приземлится ядро. А как только ядро покидает барель вам нужно заботиться о давлении воздуха, давление меняется если вы двигаетесь вверх или вниз, температура, плотность воздуха также меняется. Ядро это не идеальная сфера, а сфероид и это влияет на аэродинамику. Это очень сложная проблема для детерминистической симуляции. Вместо такой симуляции Кэмпбелл предлагает моделировать стрельбу из пушки, используя вероятностные распределения. Который заключается в следующем. Мы берем пушку, заряжаем ее 100 раз смотрим куда приземлилось ядро после стрельбы. Строим распределение вероятности о том в какие координаты попадает ядро. Это дисперсионная картина получается из различий в атмосфере и в ядре. Вместо того что бы тратить недели расчетов на суперкомпьютере, мы  за микросекунды компьютерного времени выбираем координаты из распределения.

Исходя из расчетов Бострома можно предположить что наша симуляция далеко не первая. Имея в виду то что одновременно существуют миллионы симуляций подобной нашей мы наверняка находимся где-то в середине нежели в начале, в самой первой симуляции. Поэтому можно предположить что компьютеры будущего сделали большинство трудоемких детерминистических расчетов которые требуются для тривиальных задач вроде приготовления яичницы. Но когда речь заходит о моделировании новой ракеты или самолета здесь будет определенный скачок в нагрузке на процессор симулятора. Но только на этапе его разработки и испытаний. Пока неготовы узлы самолета, необходимо честно симулировать все сигналы проходящие через электрические схемы для выявления отказов и багов в ПО.  Пока логика работы системы не устоялась и пока не будет найдены необходимые оптимизации или не будут вычислены вероятностные распределения. Учитывая то что симуляции можно ставить на паузу и то что у нас определенный запас в ресурсах это не составит большой проблемы. 

Тоже самое касается сигналов сотовых телефонов. В симуляции нет никаких радиоволн или полей (поле - это математическая абстракция) есть только потоки данных. Не имеет смысл моделировать передачу сигнала через электромагнитные волны или логику передатчика и приемника(буквально как электрический сигнал проходит через транзисторы). Это все моделируется один раз при разработке системы. Достаточно иметь данные о состоянии среды (уровень помех), знать не включил ли кто глушилку, не сломался ли передатчик\приемник или не вклинился кто-то в линию. В случае включенной глушилки не требуется моделирование распространения радиоволн в пространстве и расчет искажений сигнала. Достаточно знать параметры глушилки, включена или выключена, потому что ее параметры также известны. Если кто-то вклинился в линию вам необходимо перенаправить поток данных.

Внутренности любых объектов, будь-то транспорт, люди, тараканы отображать не имеет смысла большую 
часть времени, пока вы не раздавили таракана или пока не выпустили кому-то кишки наружу. :)
В симуляции не имеет смысла рисовать молекулы воздуха чтобы кто-то из игроков ими дышал. Никто не упадет в обморок от удушья ведь мы не в ньютоновской обьективной реальности.  Даже если кто-нибудь захочет замерить уровень кислорода прибором, прибор не покажет 0. Ведь вероятно то что в комнате полно кислорода, ведь на улице много деревьев. Вообще же данные любых приборов можно симулировать на основании вероятностных распределений, набора правил и согласованность с историей. В случае если кто-то кинет газовую гранату в комнату, обращаемся к статистике выживаемости людей при такой-то концентрации такого-то вещества в крови или в легких. Если кто-то захочет измерить наличие молекул в крови вот здесь нужно симулировать молекулы чтобы сохранить согласованность с историей.

Чисто статистически можно представить что очень детальных симуляций в которых мало оптимизаций и все честно симулируется вплоть до атома меньше чем оптимальных и соответсвенно менее детальных.
Как пишет А. Турчин  "С другой стороны, симуляции, сделанные «наспех», будет содержать гораздо больше глюков, но при этом потреблять неизмеримо меньше вычислительных ресурсов. Иначе говоря, с одинаковыми расходами можно было бы сделать или одну очень точную симуляцию, или миллион приблизительных. Далее, мы предполагаем, что в отношении симуляций действует тот же принцип, что и в отношении других вещей: а именно, что чем дешевле вещь, тем чаще она встречается (то есть в мире больше стекляшек, чем бриллиантов, больше метеоритов, чем астероидов и т. д.) Таким образом, мы, скорее, находимся внутри дешёвой упрощённой симуляции, а не внутри сложной сверхточной симуляции."


## Оптимизации на уровне физики элементарных частиц.
В знаменитом эксперименте с двумя щелями свет проявляет свои корпускулярно-волновые свойства. Если есть наблюдатель (чем может быть и фотодетектор) то свет ведет себя как частица, если нет то и частицы нет.


## Роль наблюдателя
Здесь можно указать что что в квантовой механике существуют несколько интерпретаций. 
Традиционная копенгагенская утверждает что коллапс волновой функции вызывает наблюдатель или детектор. Но на самом деле декогеренцию(обнаружение) фотона может вызвать окружающая среда например молекула воздуха.

В симуляции нет мира независимого от наблюдателя и нет обьективной реальности в классическом смысле. Если вы едите на велосипеде по дачной каменистой дорожке и кроме вас на этой дороге больше никого нет ( включая камеры с видеомагнитофоном, кошек и собак ). Пускай на улице ветер. Вы сворачиваете с этой дороги. Теперь на ней нет наблюдателей. Не для кого рендерить эту дорожку. Даже если какой-то камешек или ветка потенциально могли сместиться под воздействием ветра эти физические расчеты будут отсечены т.е. не будут выполнены . Вы все равно не помните где какой камешек был и какая ветка где лежала. Также как и в примере с лесом при новом заезде на эту дорожку система сгенерирует новое распределение камней по дороге. Такие мелкие детали не имеет смысла хранить в памяти симулятора, и тем белее все атомы и молекулы из которых состоят камни. Если вы потеряете равновесие и сломаете ногу на каком-то из камней, то разветвление истории будет только в случае. если вы не NPC если вы играете какую-то потенциально важную роль в истории. 

Теперь история о мертвом дереве в лесу. Связь с процедурной генерацией мира и экономия памяти симулятора. Допустим мужик зашел в лес и увидел там сваленное мертвое дерево. Почему он его увидел. Ну это было вероятно, вероятно что среди 50 деревьев в лесу найдется одно мертвое. Это не значит что оно стояло, а потом упало. Это значит только что оно мертвое. Далее он вернулся через пять лет и дерево все еще лежит на том же месте. Потому что информация о том что оно мертвое и лежит на земле хранится в его памяти. Дальше он уходит еще дальше в лес где его благополучно съедает медведь. Другой человек приходит спустя некоторое время в тот же лес. Будет ли он видеть мертвое дерево? Возможно будет а возможно и нет. Для него будет осуществлен новая случайная выборка из 50 нормальных стоящих деревьев.

## Мозг сима (симулированного существа)
Мозг который видят нейробиологи через ПЭТ или когда непосредственно его извлекают может не представлять из себя ничего кроме простой воксельной текстуры (или карты деформаций) функция которой просто обьяснить другим симам что с ним не так. Если к примеру сим ударился головой или у него лопнул сосуд, он перестает двигаться нормально. Ходит хромая, говорит невнятно и тд. Но в некоторых особенных случаях робастность реальной сознательной надсистемы позволяет улучшить какие-то другие умственные функции. Например обостряется слух если повреждена визуальная часть воксельной текстуры. 

Подтверждения этой гипотезе мы можем найти в противоречивых фактических сведениях в науках о языке.
К примеру раньше считалось что вычисления связанные с языком выполняет локализованная область мозга под названием зона Брока.
То новые сведения говорят о том что язык рассосредоточен по всему мозгу. 
Квентин Тарантино в одном из своих интервью рассказывал о человеке у которого в результате травмы отказала "английская часть мозга" и он стал говорить на испанском. 

Были примеры людей савантов вычисляющих умножения 8-значных цифр за секунды, но в целом они не могли вести самостоятельную жизнь. Другие могли вести нормальную даже семейную жизнь, имели работу, содержали семью, а когда ученые посмотрели их мозг через мрт окказывалось что у них все лишь тонкий кусок так называемого нейрокортекса прикрепленного к стволу мозга, а большая часть черепа залита жидкостью[15].

Теорема Геделя показала что вы не можете понять мозг используя мозг. В любой теории есть логические противоречия не обьяснимые в рамках теории.

## Парадокс друга Вигнера
[можно сделать больше деталей с описанием опыта]
Подтверждение того что объективная реальность не существует в том виде в котором предполагали последователи Ньютона. Реальность вероятностная и информационная, для всех она разная. Но согласованность в ней должна присутствовать. За согласованность истории отвечают ПОТОКИ информации.
Какие оптимизации применяются для рендеринга больших пространств в играх

Отсечение по FOV (field of view)
Описание алгоритмов рендеринга рельефа местности(quad tree) и обьектов применяемых в играх c открытым миром. 

Процедурная генерация мира в играх No man Sky или Minecraft.

Моделирование растительности пример фрактальный алгоритм L-system

## Имитация материалов
В хорошей симуляции должны быть реалистичные материалы. Диван должен быть мягким, а стол твердым, доска должна прогибаться если вы на нее встанете, пластиковая бутылка должна сминаться. Другими словами необходим расчет деформаций.
При испытании новых автомобилей проводятся математическое моделирование расчета деформаций всего кузова авто при столкновениях. Уже в начале 2000-х появились программы для 3д моделирования одежды, мягких тканей тела. Конечно же никто не моделирует одежду или мышцы на уровне молекул, это напрасная трата ресурсов, вместо этого у вас есть набор уравнений для описания деформаций поверхности при приложении к ней воздействия.
Только при разработке нового материала, проведении опытов вам необходим расчет вплоть до атомов. Для выработки адекватной математической модели необходимо знать поведение материала при изменениях температуры и давления. Все это включается в набор правил (буквально строчки програмного кода) для которой сами атомы уже не нужны. При появлении обьекта из этого материала в симуляции вам нужен только код описывающий его поведение и 3д модель объекта который сделан из этого материала. В игровых движках начиная с 2000-х для материалов применяются специальные программы для графического процессора называемые шейдерами.

## Иммитация погоды
Погоду принято моделировать используя теорию хаоса.


## Экономия энергии на вычисления мозгом

Клии Ирвин сформулировал такой абстрактный принцип который называется принцип наименьшего вычислительного действия. Когда я пишу новые программы то вместо того чтобы писать новый код с нуля я всегда ищу в своих старых программах не делал ли я что-то похожее. мозг такая машинка которая любит экономить энергию при любом удобном случае, потому что раньше с едой было не очень. Мозг изменяет себя так чтобы минимизировать свободную энергию [10]. Также похоже поступает и природа см. ссылки про фракталы ниже[5]. 

Многие произведения искусства будь то роман и сценарий кино не являются оригинальными, а основываются на чем-то уже существующим[7]. Можно привести в пример произведения Шекспира, сценарии голливуда, рисунки Ван Гога. Если посмотреть на модели самолетов истребителей сразу после 2 мировой можно увидеть общий дизайн как у самолетов СССР и США.  
Могу добавить что если написать все выводы теорем арифметики на бумаге и пронумеровать их у вас получится множество целых чисел от нуля до бесконечности. И что бы найти в этом огромном массиве нужную последовательность вывода теоремы потребуется огромная вычислительная мощь[8]. 

# Вывод. Как можно попробовать доказать гипотезу симуляции?
Основная идея этой статьи в том, что вы используете результаты расчетов в одном мире для быстрого клонирования тех же результатов в другом мире. К примеру не имеет смысла каждый раз симулировать генерацию формы картофеля начиная с генетического и молекулярного уровня.
Чтобы доказать гипотезу симуляцию кто-то может попробовать взять 1 миллион картофелин и найти несколько почти идентичных. 
Или найти формулу для функции морфинга формы, используя методы машинного обучения. Для этого нужно отсканировать в 3д картофелины и запустить некую процедуру поиска пространства функций по которой эта конкретная геометрическая структура может быть сгенерирована.
Здесь нужно учитывать, что спускаться на уровнь микроструктуры не имеет смысла. Потому что здесь такая же ситуация как с рельефом местности, микроструктура генерируется в момент когда вы делаете зум или смотрите в микроскоп.
Я не думаю что список таких формул превысит 10 позиций.
Согласно принципу Оккама, самая короткая формула будет наиболее близкой к оригинальной.

Второе направление - это поиск фрактальных структур. 
Я считаю, что продолжать попытки реверс-инженеринга симуляции полезно, хотя бы потому, что это интересный мысленный эксперимент.


Ссылки
1. N. Bostrom ARE YOU LIVING IN A COMPUTER SIMULATION?
https://www.simulation-argument.com/simulation.html
русский перевод А. Турчина https://www.proza.ru/2009/03/09/639

2. R. J. Bradbury, “Matrioshka Brains.” Working manuscript (2002), http://www.aeiveos.com/~bradbury/MatrioshkaBrains/MatrioshkaBrains.html.

3. S. Lloyd, “Ultimate physical limits to computation.” Nature 406 (31 August): 1047-1054 (2000).

4. T. Campbell "My big Toe" www.my-big-toe.com
https://www.youtube.com/watch?v=WxBOBWLAn2Y&t=1179s

5. Could our universe be fractal? https://youtu.be/tN_eNQFcv5E

6. Klee Irwin - The Principle of Efficient Language 
https://www.youtube.com/watch?v=ZxKdv-_BSZo

7. Your Brain Can't Create New Ideas 
https://youtu.be/ZjnHp5R_364

8. Николай Кузанский http://eurasialand.ru/txt/babaev/80.htm

9. Владимир Вернадский "Биосфера и ноосфера" http://www.spsl.nsc.ru/win/nelbib/vernadsky.pdf

9. Макс Тегмарк. Гипотеза математической вселенной
https://ru.wikipedia.org/wiki/%D0%93%D0%B8%D0%BF%D0%BE%D1%82%D0%B5%D0%B7%D0%B0_%D0%BC%D0%B0%D1%82%D0%B5%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B9_%D0%B2%D1%81%D0%B5%D0%BB%D0%B5%D0%BD%D0%BD%D0%BE%D0%B9

10.  Метод Монте-карло.
https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D0%9C%D0%BE%D0%BD%D1%82%D0%B5-%D0%9A%D0%B0%D1%80%D0%BB%D0%BE

11. Квантовая запутанность
https://ru.wikipedia.org/wiki/%D0%9A%D0%B2%D0%B0%D0%BD%D1%82%D0%BE%D0%B2%D0%B0%D1%8F_%D0%B7%D0%B0%D0%BF%D1%83%D1%82%D0%B0%D0%BD%D0%BD%D0%BE%D1%81%D1%82%D1%8C

12. Anders Sandberg
The Physics of Information Processing Superobjects: Daily Life Among the Jupiter Brains

13. Brains, Computation And Thermodynamics: A View From The Future?
https://www.3quarksdaily.com/3quarksdaily/2020/07/brains-computation-and-thermodynamics-a-view-from-the-future.html

14 Д Дойч "Структура реальности" 2015

15 Jim Elvidge https://www.theuniversesolved.com/

16. Deep-neural-network solution of the electronic Schrödinger equation
Jan Hermann, Zeno Schätzle & Frank Noé 
https://www.nature.com/articles/s41557-020-0544-y

17. A Bayesian Approach to the Simulation Argument
David Kipping 
https://www.mdpi.com/2218-1997/6/8/109/htm

18.Confirmed! We Live in a Simulation. We must never doubt Elon Musk again
https://www.scientificamerican.com/article/confirmed-we-live-in-a-simulation/

19. Time-Warped Foveated Rendering for Virtual Reality Headsets
Linus Franke, Laura Fink, Jana Martschinke, Kai Selgrad, Marc Stamminger
https://onlinelibrary.wiley.com/doi/full/10.1111/cgf.14176

20. RBF Liquids: An Adaptive PIC Solver Using RBF-FD
Rafael Nakanishi, Universidade de São Paulo - USP, Brazil
https://rnakanishi.github.io/files/rbf-sa2020.pdf
