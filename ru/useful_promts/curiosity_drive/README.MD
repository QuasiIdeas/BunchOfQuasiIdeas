# Know You Background Bot

**Know You Background** — маленький фоновый скрипт на Python, который периодически вытягивает из OpenAI-модели короткий, любопытный факт и показывает всплывающее окно «Знаете ли вы, что…».  
Он работает «тихо» (через `pythonw.exe`), автоматически исчезает через заданный тайм-аут и пишет полный лог всех фактов и ошибок в файл **`fact_bot.log`** рядом со скриптом.

* * *

## Возможности

- Случайная тема из большого пула (~150 областей знаний) — факты не повторяются и не «залипают» на одной эпохе.
    
- Nonce-токен в каждом запросе — снижает вероятность дублирования текста.
    
- Окно всегда поднимается поверх всех приложений и закрывается само (тайм-аут настраивается).
    
- Случайный интервал между запросами (по умолчанию 30–120 мин) — не кажется навязчивым и экономит токены.
    
- Поддерживает GPT-4o mini (или любую другую модель) с тарификацией < $1/мес при настройках «по умолчанию».
    
- Ведёт лог всех фактов и ошибок.
    

* * *

## Требования

- **Windows 10/11**
    
- **Python 3.8+** (рекомендуется из Anaconda, но подойдёт и обычный)
    
- Библиотеки:  
    `pip install --upgrade openai tkinter`  
    (tkinter входит в стандартную библиотеку CPython; в Anaconda тоже предустановлен)
    
- Переменная окружения **`OPENAI_API_KEY`** с вашим ключом OpenAI
    

* * *

## Установка

1.  **Скачайте** `know_you_background.py` в удобную папку, например  
    `C:\Scripts\know_you_background.py`
    
2.  Убедитесь, что путь к `pythonw.exe` в вашей среде известен, например  
    `C:\Users\<you>\anaconda3\pythonw.exe`
    

* * *

## Настройка

В начале файла находятся основные константы:

python

CopyEdit

`MODEL_NAME = "gpt-4o-mini" # можно "o3", когда есть доступTEMPERATURE = 0.9MIN_DELAY_MIN = 30 # мин. интервал между фактамиMAX_DELAY_MIN = 120 # макс. интервалTIMEOUT_MS = 10_000 # окно живёт 10 с`

*Увеличьте интервалы, если хотите реже обращаться к API, или уменьшите — если нужны факты чаще.*

* * *

## Запуск в фоне (без консоли)

### Через ярлык

1.  Создайте **ярлык** с объектом:
    
    arduino
    
    CopyEdit
    
    `"C:\Users\<you>\anaconda3\pythonw.exe" "C:\Scripts\know_you_background.py"`
    
2.  Положите ярлык в папку автозагрузки:  
    `Win + R` → `shell:startup` → вставьте ярлык.
    

### Через Планировщик заданий

- **Task Scheduler → Create Task**
    
    - **Trigger**: *At log on*
        
    - **Action**:  
        *Program*: `pythonw.exe`  
        *Arguments*: `"C:\Scripts\know_you_background.py"`
        
- Можно добавить задержку запуска, условия «запускать только при сети» и т.д.
    

### Сборка .exe (опционально)

bash

CopyEdit

`pip install pyinstallerpyinstaller --onefile --noconsole know_you_background.py`

Полученный `dist\know_you_background.exe` запускается так же, а ярлыку достаточно указывать путь к exe.

* * *

## Логи

- Все факты и ошибки пишутся в `fact_bot.log` (в том же каталоге, что и скрипт).
    
- Формат строки:
    
    yaml
    
    CopyEdit
    
    `2025-07-14 10:15:03,421 INFO FACT: Знаете ли вы, что ...`
    
    Ошибки помечаются уровнем **ERROR** и содержат стек-трейс.
    

* * *

## Остановка / удаление

- **Разово**: `Ctrl + Shift + Esc` → вкладка «Подробности» → `pythonw.exe` с нужным путём → *Снять задачу*.
    
- **Навсегда**: уберите ярлык из `shell:startup` или отключите/удалите задачу в Планировщике.
    
- Можно настроить файл-флаг (`stop_facts.txt`) в коде, чтобы скрипт корректно завершался сам.
    

* * *

## Экономия токенов

С настройками по умолчанию (факт каждые ~60 мин в среднем) тратится < $1 в месяц.  
Увеличьте `MIN_DELAY_MIN` / `MAX_DELAY_MIN` или кэшируйте последние факты, чтобы снизить расход ещё сильнее.